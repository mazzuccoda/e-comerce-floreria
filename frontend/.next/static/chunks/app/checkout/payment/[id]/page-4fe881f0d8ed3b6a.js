(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4615],{4782:function(e,t,r){Promise.resolve().then(r.bind(r,1564))},1564:function(e,t,r){"use strict";r.r(t);var s=r(7437),a=r(2265),n=r(9376),i=r(3145),o=r(7648),c=r(9064),l=r(257);t.default=()=>{let e=(0,n.useRouter)(),t=(0,n.useParams)().id,[r,d]=(0,a.useState)(null),[m,x]=(0,a.useState)(!0),[u,h]=(0,a.useState)(!1);(0,a.useEffect)(()=>{let r=async()=>{try{let e=await fetch("".concat(l.env.NEXT_PUBLIC_API_BASE_URL,"/api/pedidos/").concat(t,"/"),{credentials:"include"});if(!e.ok)throw Error("Pedido no encontrado");let r=await e.json();d(r)}catch(t){console.error("Error fetching pedido:",t),c.ZP.error("Error al cargar el pedido"),e.push("/")}finally{x(!1)}};t&&r()},[t,e]);let p=e=>new Intl.NumberFormat("es-AR",{style:"currency",currency:"ARS"}).format(e),f=async()=>{if(!r)return;h(!0);let e=c.ZP.loading("Creando pago...");try{let t=await fetch("".concat(l.env.NEXT_PUBLIC_API_BASE_URL,"/api/pedidos/crear-pago/"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({pedido_id:r.id})});if(c.ZP.dismiss(e),!t.ok){let e=await t.json();throw Error(e.error||"Error al crear el pago")}let s=await t.json();if(s.init_point)window.location.href=s.init_point;else throw Error("No se pudo obtener el enlace de pago")}catch(t){c.ZP.dismiss(e),c.ZP.error(t.message||"Error al procesar el pago")}finally{h(!1)}};if(m)return(0,s.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,s.jsx)("div",{className:"flex items-center justify-center min-h-64",children:(0,s.jsx)("div",{className:"w-8 h-8 border-4 border-gray-300 border-t-blue-600 rounded-full animate-spin"})})});if(!r)return(0,s.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,s.jsxs)("div",{className:"text-center py-16",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Pedido no encontrado"}),(0,s.jsx)(o.default,{href:"/",className:"inline-block px-8 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium",children:"Volver al inicio"})]})});let g=r.total+r.metodo_envio.precio;return(0,s.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,s.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,s.jsxs)("div",{className:"text-center mb-8",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Confirmar Pago"}),(0,s.jsxs)("p",{className:"text-gray-600",children:["Pedido #",r.numero_pedido]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Informaci\xf3n de Entrega"}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"Nombre"}),(0,s.jsx)("p",{className:"font-medium",children:r.nombre_completo})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"Email"}),(0,s.jsx)("p",{className:"font-medium",children:r.email})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"Tel\xe9fono"}),(0,s.jsx)("p",{className:"font-medium",children:r.telefono})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"Direcci\xf3n"}),(0,s.jsx)("p",{className:"font-medium",children:r.direccion}),(0,s.jsxs)("p",{className:"text-sm text-gray-500",children:[r.ciudad,", ",r.codigo_postal]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"Fecha de entrega"}),(0,s.jsx)("p",{className:"font-medium",children:new Date(r.fecha_entrega).toLocaleDateString("es-AR",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"M\xe9todo de env\xedo"}),(0,s.jsx)("p",{className:"font-medium",children:r.metodo_envio.nombre}),(0,s.jsx)("p",{className:"text-sm text-gray-500",children:r.metodo_envio.tiempo_estimado})]}),r.notas&&(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"Notas"}),(0,s.jsx)("p",{className:"font-medium",children:r.notas})]})]})]}),(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Productos"}),(0,s.jsx)("div",{className:"space-y-4",children:r.items.map(e=>(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsx)("div",{className:"relative w-16 h-16 flex-shrink-0",children:(0,s.jsx)(i.default,{src:e.producto.imagen_principal||"/placeholder-product.jpg",alt:e.producto.nombre,fill:!0,className:"object-cover rounded-lg"})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("h3",{className:"font-medium text-gray-900 truncate",children:e.producto.nombre}),(0,s.jsxs)("p",{className:"text-sm text-gray-600",children:["Cantidad: ",e.quantity," \xd7 ",p(e.precio)]})]}),(0,s.jsx)("div",{className:"text-right",children:(0,s.jsx)("p",{className:"font-medium text-gray-900",children:p(e.total_price)})})]},e.id))})]})]}),(0,s.jsx)("div",{className:"lg:col-span-1",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border p-6 sticky top-4",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Resumen del Pago"}),(0,s.jsxs)("div",{className:"space-y-3 mb-6",children:[(0,s.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,s.jsx)("span",{className:"text-gray-600",children:"Subtotal"}),(0,s.jsx)("span",{className:"font-medium",children:p(r.total)})]}),(0,s.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,s.jsx)("span",{className:"text-gray-600",children:"Env\xedo"}),(0,s.jsx)("span",{className:"font-medium",children:0===r.metodo_envio.precio?"Gratis":p(r.metodo_envio.precio)})]}),(0,s.jsx)("div",{className:"border-t pt-3",children:(0,s.jsxs)("div",{className:"flex justify-between text-lg font-semibold",children:[(0,s.jsx)("span",{children:"Total a pagar"}),(0,s.jsx)("span",{children:p(g)})]})})]}),(0,s.jsx)("button",{onClick:f,disabled:u,className:"w-full bg-blue-600 text-white py-4 px-6 rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium text-lg mb-4",children:u?(0,s.jsxs)("div",{className:"flex items-center justify-center",children:[(0,s.jsx)("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Procesando..."]}):"Pagar con Mercado Pago"}),(0,s.jsxs)("div",{className:"space-y-2 text-sm text-gray-600",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("svg",{className:"w-4 h-4 mr-2 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),"Pago 100% seguro"]}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("svg",{className:"w-4 h-4 mr-2 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Protecci\xf3n al comprador"]}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("svg",{className:"w-4 h-4 mr-2 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"M\xfaltiples medios de pago"]})]}),(0,s.jsxs)("div",{className:"mt-6 pt-6 border-t",children:[(0,s.jsx)("p",{className:"text-sm text-gray-600 mb-3",children:"M\xe9todos de pago aceptados:"}),(0,s.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,s.jsx)("div",{className:"px-3 py-1 bg-gray-100 rounded text-xs font-medium text-gray-700",children:"Tarjetas de cr\xe9dito"}),(0,s.jsx)("div",{className:"px-3 py-1 bg-gray-100 rounded text-xs font-medium text-gray-700",children:"Tarjetas de d\xe9bito"}),(0,s.jsx)("div",{className:"px-3 py-1 bg-gray-100 rounded text-xs font-medium text-gray-700",children:"Transferencia"}),(0,s.jsx)("div",{className:"px-3 py-1 bg-gray-100 rounded text-xs font-medium text-gray-700",children:"Efectivo"})]})]}),(0,s.jsx)("div",{className:"mt-6 pt-6 border-t",children:(0,s.jsx)(o.default,{href:"/carrito",className:"block w-full text-center py-3 px-4 bg-gray-100 text-gray-900 rounded-lg hover:bg-gray-200 transition-colors font-medium",children:"Volver al carrito"})})]})})]})]})})}},9376:function(e,t,r){"use strict";var s=r(5475);r.o(s,"useParams")&&r.d(t,{useParams:function(){return s.useParams}}),r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}}),r.o(s,"useSearchParams")&&r.d(t,{useSearchParams:function(){return s.useSearchParams}})},257:function(e,t,r){"use strict";var s,a;e.exports=(null==(s=r.g.process)?void 0:s.env)&&"object"==typeof(null==(a=r.g.process)?void 0:a.env)?r.g.process:r(4227)},4227:function(e){!function(){var t={229:function(e){var t,r,s,a=e.exports={};function n(){throw Error("setTimeout has not been defined")}function i(){throw Error("clearTimeout has not been defined")}function o(e){if(t===setTimeout)return setTimeout(e,0);if((t===n||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(r){try{return t.call(null,e,0)}catch(r){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:n}catch(e){t=n}try{r="function"==typeof clearTimeout?clearTimeout:i}catch(e){r=i}}();var c=[],l=!1,d=-1;function m(){l&&s&&(l=!1,s.length?c=s.concat(c):d=-1,c.length&&x())}function x(){if(!l){var e=o(m);l=!0;for(var t=c.length;t;){for(s=c,c=[];++d<t;)s&&s[d].run();d=-1,t=c.length}s=null,l=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===i||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function u(e,t){this.fun=e,this.array=t}function h(){}a.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];c.push(new u(e,t)),1!==c.length||l||o(x)},u.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=h,a.addListener=h,a.once=h,a.off=h,a.removeListener=h,a.removeAllListeners=h,a.emit=h,a.prependListener=h,a.prependOnceListener=h,a.listeners=function(e){return[]},a.binding=function(e){throw Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(e){throw Error("process.chdir is not supported")},a.umask=function(){return 0}}},r={};function s(e){var a=r[e];if(void 0!==a)return a.exports;var n=r[e]={exports:{}},i=!0;try{t[e](n,n.exports,s),i=!1}finally{i&&delete r[e]}return n.exports}s.ab="//";var a=s(229);e.exports=a}()}},function(e){e.O(0,[9064,7648,3145,2971,2117,1744],function(){return e(e.s=4782)}),_N_E=e.O()}]);