(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5527],{2196:function(e,r,t){Promise.resolve().then(t.bind(t,5411))},5411:function(e,r,t){"use strict";t.r(r);var s=t(7437),a=t(2265),n=t(575),i=t(9376),o=t(7648),c=t(257);r.default=()=>{let{token:e,loading:r,isAuthenticated:t}=(0,n.a)(),l=(0,i.useRouter)(),d=(0,i.useParams)(),u=null==d?void 0:d.id,[m,h]=(0,a.useState)(null),[p,f]=(0,a.useState)(!0),[x,g]=(0,a.useState)(null);if((0,a.useEffect)(()=>{r||t||l.push("/login")},[t,r,l]),(0,a.useEffect)(()=>{let r=async()=>{if(e&&u)try{f(!0);let r=c.env.NEXT_PUBLIC_API_URL||"https://e-comerce-floreria-production.up.railway.app/api",t=await fetch("".concat(r,"/pedidos/simple/").concat(u,"/"),{headers:{Authorization:"Token ".concat(e),Accept:"application/json"},credentials:"include"});if(t.ok){let e=await t.json();h(e)}else{let e=await t.json();g(e.error||"Error al cargar el pedido")}}catch(e){console.error("Error cargando pedido:",e),g("Error de conexi\xf3n")}finally{f(!1)}};t&&e&&u&&r()},[t,e,u]),r||p)return(0,s.jsx)("div",{className:"flex justify-center items-center min-h-[400px]",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-700"})});if(x||!m)return(0,s.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,s.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded mb-4",children:x||"Pedido no encontrado"}),(0,s.jsx)(o.default,{href:"/mis-pedidos",className:"text-green-700 hover:underline",children:"← Volver a Mis Pedidos"})]});let j=m.items.reduce((e,r)=>e+parseFloat(r.precio)*r.cantidad,0);return(0,s.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,s.jsx)("div",{className:"mb-4",children:(0,s.jsxs)(o.default,{href:"/mis-pedidos",className:"text-green-700 hover:underline flex items-center gap-2",children:[(0,s.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Volver a Mis Pedidos"]})}),(0,s.jsxs)("div",{className:"bg-white shadow-lg rounded-lg p-6",children:[(0,s.jsx)("div",{className:"border-b pb-4 mb-6",children:(0,s.jsxs)("div",{className:"flex justify-between items-start",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("h1",{className:"text-3xl font-bold text-gray-800",children:["Pedido #",m.numero_pedido]}),(0,s.jsx)("p",{className:"text-gray-600 mt-1",children:new Date(m.creado).toLocaleDateString("es-AR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})})]}),(0,s.jsx)("span",{className:"inline-block px-4 py-2 rounded-full text-sm font-medium ".concat("pendiente"===m.estado?"bg-yellow-100 text-yellow-800":"confirmado"===m.estado?"bg-blue-100 text-blue-800":"en_camino"===m.estado?"bg-purple-100 text-purple-800":"entregado"===m.estado?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"),children:m.estado_display||m.estado.toUpperCase()})]})}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-3",children:"Datos del Comprador"}),(0,s.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg space-y-2",children:[(0,s.jsxs)("p",{children:[(0,s.jsx)("span",{className:"font-medium",children:"Nombre:"})," ",m.nombre_comprador]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("span",{className:"font-medium",children:"Email:"})," ",m.email_comprador]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("span",{className:"font-medium",children:"Tel\xe9fono:"})," ",m.telefono_comprador]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-3",children:"Datos de Entrega"}),(0,s.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg space-y-2",children:[(0,s.jsxs)("p",{children:[(0,s.jsx)("span",{className:"font-medium",children:"Destinatario:"})," ",m.nombre_destinatario]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("span",{className:"font-medium",children:"Direcci\xf3n:"})," ",m.direccion]}),m.ciudad&&(0,s.jsxs)("p",{children:[(0,s.jsx)("span",{className:"font-medium",children:"Ciudad:"})," ",m.ciudad]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("span",{className:"font-medium",children:"Tel\xe9fono:"})," ",m.telefono_destinatario]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("span",{className:"font-medium",children:"Fecha:"})," ",new Date(m.fecha_entrega).toLocaleDateString("es-AR")]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("span",{className:"font-medium",children:"Horario:"})," ","ma\xf1ana"===m.franja_horaria?"Ma\xf1ana (9-12hs)":"Tarde (16-20hs)"]})]})]})]}),m.dedicatoria&&(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-3",children:"Dedicatoria"}),(0,s.jsx)("div",{className:"bg-green-50 p-4 rounded-lg border border-green-100",children:(0,s.jsx)("p",{className:"italic",children:m.dedicatoria})})]}),m.instrucciones&&(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-3",children:"Instrucciones Especiales"}),(0,s.jsx)("div",{className:"bg-gray-50 p-4 rounded-lg",children:(0,s.jsx)("p",{children:m.instrucciones})})]}),(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-3",children:"Productos"}),(0,s.jsx)("div",{className:"border rounded-lg overflow-hidden",children:(0,s.jsxs)("table",{className:"w-full",children:[(0,s.jsx)("thead",{className:"bg-gray-50",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"text-left p-4",children:"Producto"}),(0,s.jsx)("th",{className:"text-center p-4",children:"Cantidad"}),(0,s.jsx)("th",{className:"text-right p-4",children:"Precio Unit."}),(0,s.jsx)("th",{className:"text-right p-4",children:"Subtotal"})]})}),(0,s.jsx)("tbody",{children:m.items.map(e=>(0,s.jsxs)("tr",{className:"border-t",children:[(0,s.jsx)("td",{className:"p-4",children:e.producto_nombre}),(0,s.jsx)("td",{className:"text-center p-4",children:e.cantidad}),(0,s.jsxs)("td",{className:"text-right p-4",children:["$",parseFloat(e.precio).toFixed(2)]}),(0,s.jsxs)("td",{className:"text-right p-4 font-medium",children:["$",(parseFloat(e.precio)*e.cantidad).toFixed(2)]})]},e.id))})]})})]}),(0,s.jsxs)("div",{className:"border-t pt-4",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,s.jsx)("span",{className:"text-gray-600",children:"Subtotal:"}),(0,s.jsxs)("span",{className:"font-medium",children:["$",j.toFixed(2)]})]}),(0,s.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,s.jsx)("span",{className:"text-gray-600",children:"M\xe9todo de pago:"}),(0,s.jsx)("span",{className:"font-medium",children:m.medio_pago_display||m.medio_pago})]}),(0,s.jsxs)("div",{className:"flex justify-between items-center text-xl font-bold mt-4 pt-4 border-t",children:[(0,s.jsx)("span",{children:"Total:"}),(0,s.jsxs)("span",{className:"text-green-700",children:["$",parseFloat(m.total).toFixed(2)]})]})]})]})]})}},575:function(e,r,t){"use strict";t.d(r,{AuthProvider:function(){return l},a:function(){return c}});var s=t(7437),a=t(2265),n=t(9064),i=t(257);let o=(0,a.createContext)(void 0),c=()=>{let e=(0,a.useContext)(o);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e},l=e=>{let{children:r}=e,[t,c]=(0,a.useState)(null),[l,d]=(0,a.useState)(null),[u,m]=(0,a.useState)(!0),h=()=>i.env.NEXT_PUBLIC_API_URL||"https://e-comerce-floreria-production.up.railway.app/api",p=async function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=h(),s=await fetch("".concat(t).concat(e),{credentials:"include",mode:"cors",headers:{"Content-Type":"application/json",Accept:"application/json",...l&&{Authorization:"Token ".concat(l)},...r.headers},...r});if(!s.ok)throw Error((await s.json().catch(()=>({}))).error||"HTTP error! status: ".concat(s.status));return s.json()};(0,a.useEffect)(()=>{let e=localStorage.getItem("auth_token"),r=localStorage.getItem("auth_user");e&&r&&(d(e),c(JSON.parse(r))),m(!1)},[]);let f=async(e,r)=>{try{m(!0);let t=await p("/usuarios/simple/login/",{method:"POST",body:JSON.stringify({username:e,password:r})});return c(t.user),d(t.token),localStorage.setItem("auth_token",t.token),localStorage.setItem("auth_user",JSON.stringify(t.user)),n.Am.success("\xa1Bienvenido, ".concat(t.user.first_name||t.user.username,"!")),!0}catch(r){let e=r instanceof Error?r.message:"Error desconocido";return n.Am.error("Error al iniciar sesi\xf3n: ".concat(e)),!1}finally{m(!1)}},x=async e=>{try{m(!0);let r=await p("/usuarios/simple/registro/",{method:"POST",body:JSON.stringify(e)});return c(r.user),d(r.token),localStorage.setItem("auth_token",r.token),localStorage.setItem("auth_user",JSON.stringify(r.user)),n.Am.success("\xa1Cuenta creada exitosamente! Bienvenido, ".concat(r.user.first_name||r.user.username,"!")),!0}catch(r){let e=r instanceof Error?r.message:"Error desconocido";return n.Am.error("Error al registrarse: ".concat(e)),!1}finally{m(!1)}},g=async()=>{try{l&&await p("/usuarios/simple/logout/",{method:"POST"})}catch(e){console.error("Error al hacer logout:",e)}finally{c(null),d(null),localStorage.removeItem("auth_token"),localStorage.removeItem("auth_user"),n.Am.success("Sesi\xf3n cerrada exitosamente")}},j=async e=>{try{m(!0);let r=await p("/usuarios/simple/perfil/",{method:"PUT",body:JSON.stringify(e)});return c(r.user),localStorage.setItem("auth_user",JSON.stringify(r.user)),n.Am.success("Perfil actualizado exitosamente"),!0}catch(r){let e=r instanceof Error?r.message:"Error desconocido";return n.Am.error("Error al actualizar perfil: ".concat(e)),!1}finally{m(!1)}};return(0,s.jsx)(o.Provider,{value:{user:t,token:l,loading:u,login:f,register:x,logout:g,updateProfile:j,isAuthenticated:!!t&&!!l},children:r})}},9376:function(e,r,t){"use strict";var s=t(5475);t.o(s,"useParams")&&t.d(r,{useParams:function(){return s.useParams}}),t.o(s,"useRouter")&&t.d(r,{useRouter:function(){return s.useRouter}}),t.o(s,"useSearchParams")&&t.d(r,{useSearchParams:function(){return s.useSearchParams}})},257:function(e,r,t){"use strict";var s,a;e.exports=(null==(s=t.g.process)?void 0:s.env)&&"object"==typeof(null==(a=t.g.process)?void 0:a.env)?t.g.process:t(4227)},4227:function(e){!function(){var r={229:function(e){var r,t,s,a=e.exports={};function n(){throw Error("setTimeout has not been defined")}function i(){throw Error("clearTimeout has not been defined")}function o(e){if(r===setTimeout)return setTimeout(e,0);if((r===n||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:n}catch(e){r=n}try{t="function"==typeof clearTimeout?clearTimeout:i}catch(e){t=i}}();var c=[],l=!1,d=-1;function u(){l&&s&&(l=!1,s.length?c=s.concat(c):d=-1,c.length&&m())}function m(){if(!l){var e=o(u);l=!0;for(var r=c.length;r;){for(s=c,c=[];++d<r;)s&&s[d].run();d=-1,r=c.length}s=null,l=!1,function(e){if(t===clearTimeout)return clearTimeout(e);if((t===i||!t)&&clearTimeout)return t=clearTimeout,clearTimeout(e);try{t(e)}catch(r){try{return t.call(null,e)}catch(r){return t.call(this,e)}}}(e)}}function h(e,r){this.fun=e,this.array=r}function p(){}a.nextTick=function(e){var r=Array(arguments.length-1);if(arguments.length>1)for(var t=1;t<arguments.length;t++)r[t-1]=arguments[t];c.push(new h(e,r)),1!==c.length||l||o(m)},h.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=p,a.addListener=p,a.once=p,a.off=p,a.removeListener=p,a.removeAllListeners=p,a.emit=p,a.prependListener=p,a.prependOnceListener=p,a.listeners=function(e){return[]},a.binding=function(e){throw Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(e){throw Error("process.chdir is not supported")},a.umask=function(){return 0}}},t={};function s(e){var a=t[e];if(void 0!==a)return a.exports;var n=t[e]={exports:{}},i=!0;try{r[e](n,n.exports,s),i=!1}finally{i&&delete t[e]}return n.exports}s.ab="//";var a=s(229);e.exports=a}()}},function(e){e.O(0,[9064,7648,2971,2117,1744],function(){return e(e.s=2196)}),_N_E=e.O()}]);