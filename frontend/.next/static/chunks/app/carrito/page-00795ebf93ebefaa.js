(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6707],{8574:function(e,t,r){Promise.resolve().then(r.bind(r,3161))},3161:function(e,t,r){"use strict";r.r(t);var n=r(7437),s=r(2265),a=r(7648),o=r(257);let i=()=>o.env.NEXT_PUBLIC_API_URL||"https://e-comerce-floreria-production.up.railway.app/api";t.default=()=>{var e;let[t,r]=(0,s.useState)(null),[o,l]=(0,s.useState)(!0),[c,d]=(0,s.useState)(null),[u,m]=(0,s.useState)(null),h=async()=>{try{l(!0),d(null);let e=i();console.log("\uD83D\uDCE1 Conectando con API en:","".concat(e,"/carrito/simple/"));let t=await fetch("".concat(e,"/carrito/simple/"),{method:"GET",credentials:"include",headers:{Accept:"application/json","Content-Type":"application/json","Cache-Control":"no-cache, no-store",Pragma:"no-cache"},cache:"no-store"});if(!t.ok)throw Error("HTTP ".concat(t.status,": ").concat(t.statusText));let n=await t.json();r(n)}catch(e){console.error("❌ Error fetching cart:",e),d(e.message)}finally{l(!1)}},p=async(e,t)=>{if(!(t<1)){m(e);try{let r=i();console.log("\uD83D\uDCE1 Enviando actualizaci\xf3n a:","".concat(r,"/carrito/simple/update/"));let n=await fetch("".concat(r,"/carrito/simple/update/"),{method:"POST",credentials:"include",headers:{Accept:"application/json","Content-Type":"application/json","Cache-Control":"no-cache"},body:JSON.stringify({product_id:e,quantity:t})});n.ok?await h():console.error("Error en respuesta:",n.status,n.statusText)}catch(e){console.error("Error updating quantity:",e)}finally{m(null)}}},x=async e=>{m(e);try{let t=i();console.log("\uD83D\uDCE1 Eliminando producto:","".concat(t,"/carrito/simple/remove/"));let r=await fetch("".concat(t,"/carrito/simple/remove/"),{method:"POST",credentials:"include",headers:{Accept:"application/json","Content-Type":"application/json","Cache-Control":"no-cache"},body:JSON.stringify({product_id:e})});r.ok?await h():console.error("Error en respuesta:",r.status,r.statusText)}catch(e){console.error("Error removing item:",e)}finally{m(null)}};return((0,s.useEffect)(()=>{h()},[]),o)?(0,n.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"w-16 h-16 border-4 border-gray-300 border-t-pink-600 rounded-full animate-spin mx-auto mb-4"}),(0,n.jsx)("p",{className:"text-gray-600",children:"Cargando tu carrito..."})]})}):c?(0,n.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,n.jsxs)("div",{className:"text-center max-w-md mx-auto px-4",children:[(0,n.jsx)("div",{className:"text-6xl mb-4",children:"⚠️"}),(0,n.jsx)("h1",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Error de Conexi\xf3n"}),(0,n.jsx)("p",{className:"text-gray-600 mb-6",children:c}),(0,n.jsx)("button",{onClick:h,className:"bg-green-700 text-white px-6 py-3 rounded-lg hover:bg-green-800 transition",children:"Reintentar"})]})}):(0,n.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,n.jsxs)("div",{className:"container mx-auto px-4 max-w-6xl",children:[(0,n.jsxs)("div",{className:"mb-8",children:[(0,n.jsx)("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"\uD83D\uDED2 Tu Carrito"}),(0,n.jsxs)("p",{className:"text-gray-600",children:[(null==t?void 0:t.total_items)||0," ",(null==t?void 0:t.total_items)===1?"producto":"productos"," en tu carrito"]})]}),(null==t?void 0:t.is_empty)?(0,n.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-12 text-center",children:[(0,n.jsx)("div",{className:"text-8xl mb-6",children:"\uD83C\uDF38"}),(0,n.jsx)("h2",{className:"text-2xl font-bold text-gray-800 mb-3",children:"Tu carrito est\xe1 vac\xedo"}),(0,n.jsx)("p",{className:"text-gray-600 mb-8",children:"\xa1Descubre nuestros hermosos arreglos florales!"}),(0,n.jsx)(a.default,{href:"/",className:"inline-block bg-green-700 text-white px-8 py-3 rounded-lg hover:bg-green-800 transition font-medium",children:"Ver Productos"})]}):(0,n.jsxs)("div",{className:"grid lg:grid-cols-3 gap-8",children:[(0,n.jsx)("div",{className:"lg:col-span-2 space-y-4",children:null==t?void 0:null===(e=t.items)||void 0===e?void 0:e.map(e=>(0,n.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6 flex gap-6",children:[(0,n.jsx)("div",{className:"w-24 h-24 bg-gray-100 rounded-lg flex-shrink-0 overflow-hidden",children:e.producto.imagen_principal?(0,n.jsx)("img",{src:e.producto.imagen_principal,alt:e.producto.nombre,className:"w-full h-full object-cover"}):(0,n.jsx)("div",{className:"w-full h-full flex items-center justify-center text-gray-400",children:"\uD83C\uDF38"})}),(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsx)("h3",{className:"font-semibold text-gray-800 mb-1",children:e.producto.nombre}),(0,n.jsxs)("p",{className:"text-green-700 font-medium",children:["$",e.price]}),(0,n.jsxs)("div",{className:"flex items-center gap-3 mt-4",children:[(0,n.jsx)("button",{onClick:()=>p(e.producto.id,e.quantity-1),disabled:u===e.producto.id||e.quantity<=1,className:"w-8 h-8 rounded-full border border-gray-300 hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed transition",children:"−"}),(0,n.jsx)("span",{className:"w-12 text-center font-medium",children:e.quantity}),(0,n.jsx)("button",{onClick:()=>p(e.producto.id,e.quantity+1),disabled:u===e.producto.id,className:"w-8 h-8 rounded-full border border-gray-300 hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed transition",children:"+"}),(0,n.jsx)("button",{onClick:()=>x(e.producto.id),disabled:u===e.producto.id,className:"ml-auto text-red-600 hover:text-red-700 text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:"Eliminar"})]})]}),(0,n.jsx)("div",{className:"text-right",children:(0,n.jsxs)("p",{className:"font-bold text-gray-800",children:["$",e.total_price]})})]},e.producto.id))}),(0,n.jsx)("div",{className:"lg:col-span-1",children:(0,n.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6 sticky top-4",children:[(0,n.jsx)("h2",{className:"text-xl font-bold text-gray-800 mb-6",children:"Resumen del Pedido"}),(0,n.jsxs)("div",{className:"space-y-3 mb-6",children:[(0,n.jsxs)("div",{className:"flex justify-between text-gray-600",children:[(0,n.jsxs)("span",{children:["Subtotal (",null==t?void 0:t.total_items," ",(null==t?void 0:t.total_items)===1?"producto":"productos",")"]}),(0,n.jsxs)("span",{children:["$",null==t?void 0:t.total_price]})]}),(0,n.jsxs)("div",{className:"flex justify-between text-gray-600",children:[(0,n.jsx)("span",{children:"Env\xedo"}),(0,n.jsx)("span",{className:"text-green-600",children:"A calcular"})]}),(0,n.jsxs)("div",{className:"border-t pt-3 flex justify-between font-bold text-lg",children:[(0,n.jsx)("span",{children:"Total"}),(0,n.jsxs)("span",{className:"text-green-700",children:["$",null==t?void 0:t.total_price]})]})]}),(0,n.jsx)(a.default,{href:"/checkout",className:"block w-full bg-green-700 text-white text-center py-3 rounded-lg hover:bg-green-800 transition font-medium mb-3",children:"Proceder al Checkout"}),(0,n.jsx)(a.default,{href:"/",className:"block w-full border border-gray-300 text-gray-700 text-center py-3 rounded-lg hover:bg-gray-50 transition font-medium",children:"Seguir Comprando"}),(0,n.jsxs)("div",{className:"mt-6 pt-6 border-t space-y-3 text-sm text-gray-600",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("span",{children:"✓"}),(0,n.jsx)("span",{children:"Entrega garantizada"})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("span",{children:"✓"}),(0,n.jsx)("span",{children:"Flores frescas del d\xeda"})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("span",{children:"✓"}),(0,n.jsx)("span",{children:"Pago seguro"})]})]})]})})]})]})})}},257:function(e,t,r){"use strict";var n,s;e.exports=(null==(n=r.g.process)?void 0:n.env)&&"object"==typeof(null==(s=r.g.process)?void 0:s.env)?r.g.process:r(4227)},4227:function(e){!function(){var t={229:function(e){var t,r,n,s=e.exports={};function a(){throw Error("setTimeout has not been defined")}function o(){throw Error("clearTimeout has not been defined")}function i(e){if(t===setTimeout)return setTimeout(e,0);if((t===a||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(r){try{return t.call(null,e,0)}catch(r){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:a}catch(e){t=a}try{r="function"==typeof clearTimeout?clearTimeout:o}catch(e){r=o}}();var l=[],c=!1,d=-1;function u(){c&&n&&(c=!1,n.length?l=n.concat(l):d=-1,l.length&&m())}function m(){if(!c){var e=i(u);c=!0;for(var t=l.length;t;){for(n=l,l=[];++d<t;)n&&n[d].run();d=-1,t=l.length}n=null,c=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===o||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function p(){}s.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];l.push(new h(e,t)),1!==l.length||c||i(m)},h.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=p,s.addListener=p,s.once=p,s.off=p,s.removeListener=p,s.removeAllListeners=p,s.emit=p,s.prependListener=p,s.prependOnceListener=p,s.listeners=function(e){return[]},s.binding=function(e){throw Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(e){throw Error("process.chdir is not supported")},s.umask=function(){return 0}}},r={};function n(e){var s=r[e];if(void 0!==s)return s.exports;var a=r[e]={exports:{}},o=!0;try{t[e](a,a.exports,n),o=!1}finally{o&&delete r[e]}return a.exports}n.ab="//";var s=n(229);e.exports=s}()}},function(e){e.O(0,[7648,2971,2117,1744],function(){return e(e.s=8574)}),_N_E=e.O()}]);